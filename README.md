# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

### Данные и типы данных, используемые в приложении
Карточка товара

```
export interface ICard {
   id: string;  
   title: string;
   price: number;
   image: string;
   category: string;
   description: string;
}
```

Информация о покупателе

```
export interface IUser {
  address: string;
  phone: string;
  email: string; 
  payOnline: boolean; 
  saveUserInfo(data: TOrder | TUserContacts): void;
}
```

Интерфейс для модели данных карточек товаров

```
export interface ICardsData {
  cards: ICard[]
  loadCardCollection(): Promise<void>;
  openCard (card: ICard): void;
}
```

Данные о покупателе, используемые в форме для указания информации о заказе, включающее адрес и флаг онлайн-оплаты.

```
export type TOrder = Pick<IUser, 'payOnline' | 'address'>; 
```

Данные о покупателе, используемые в форме для указания его контактных данных, включающее электронную почту и номер телефона.

```
export type TUserContacts = Pick<IUser, 'email' | 'phone'>; 
```

Общая стоимость покупки для формы подтверждения заказа. 

```
export type TOrderConfirmation = Pick<IBasket, 'totalPrice'>;
```


## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP: 
- слой представления, отвечает за отображение данных на странице, 
- слой данных, отвечает за хранение и изменение данных
- презентер, отвечает за связь представления и данных.

### Базовый код

#### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы: 
- `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.  
Основные методы, реализуемые классом описаны интерфейсом `IEvents`:
- `on` - подписка на событие
- `emit` - инициализация события
- `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие   

### Слой данных

#### Класс Card
Класс, представляющий карточку товара.

Поля:
- id: string: Уникальный идентификатор карточки товара.
- title: string: Наименование товара.
- price: number: Цена товара.
- image: string: Ссылка на изображение товара.
- category: string: Категория товара.
- description: string: Описание товара.

#### Класс CardsData
Класс, управляющий данными о карточках товаров.

Поля:
- cards: ICard[]: Массив карточек товаров.

Методы:
- constructor(cards: ICard[]): Конструктор класса, принимает массив карточек товаров.
- getCards(): ICard[]: Возвращает все карточки товаров.
- loadCardCollection(): Promise<void>: Загружает коллекцию карточек товаров.
- openCard(card: ICard): void: Открывает указанную карточку товара.

#### Класс User
Класс, представляющий пользователя.

Поля:
- address: string: Адрес пользователя.
- phone: string: Номер телефона пользователя.
- email: string: Адрес электронной почты пользователя.
- payOnline: boolean: Флаг оплаты онлайн.

Методы:
- constructor(address: string, phone: string, email: string, payOnline: boolean): Конструктор класса, принимает данные пользователя.
- saveUserInfo(data: TOrder | TUserContacts): void: Сохраняет информацию о пользователе на сервере.


#### Класс Basket
Класс, представляющий корзину покупок.

Поля:
- items: Map<string, number>: Хранит товары и их количество в корзине.

Методы:
- constructor(items: Map<string, number>): Конструктор класса, принимает начальное состояние корзины (опционально).
- getItems(): Map<string, number>: Возвращает все товары и их количество в корзине.
- addItem(card: ICard): void: Добавляет товар в корзину.
- removeItem(id: string): void: Удаляет товар из корзины по его идентификатору.
- totalPrice(prices: number[]): number: Вычисляет общую стоимость товаров в корзине.

Дополнительные типы:
- TOrder: Модальное окно для указания информации о заказе, включающее адрес и флаг онлайн-оплаты.
- TUserContacts: Модальное окно для указания контактных данных пользователя, включающее электронную почту и номер телефона.
- TOrderConfirmation: Модальное окно для подтверждения заказа, включающее информацию о общей стоимости заказа.
